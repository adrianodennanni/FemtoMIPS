#!/usr/bin/python

import sys
import random

def main():
    pc = 0

    # 00000000000000000000000000000000
    inst = "0010100000100110" + stringBin(int(sys.argv[1]),16)
    emit(inst,pc,"for1tst: slti $6, $1, "+sys.argv[1])
    pc += 4

    # 00000000000000000000000000000100
    inst = "00010000110000000000000000001110"
    emit(inst,pc,"beq $6, $0, exit1")
    pc += 4

    # 00000000000000000000000000001000
    inst = "00100000001000101111111111111111"
    emit(inst,pc,"addi $2, $1, -1")
    pc += 4

    # 00000000000000000000000000001100
    inst = "00101000010001100000000000000000"
    emit(inst,pc,"for2tst: slti $6, $2, 0")
    pc += 4

    # 00000000000000000000000000010000
    inst = "00010100000001100000000000001001"
    emit(inst,pc,"bne $6, $0, exit2")
    pc += 4

    # 00000000000000000000000000010100
    inst = "00000000010000100011000010000000"
    emit(inst,pc,"sll $6, $2, 2")
    pc += 4

    # 00000000000000000000000000011000
    inst = "00100000110001100000000010000000"
    emit(inst,pc,"addi $6, $6, 0x80")
    pc += 4

    # 00000000000000000000000000011100
    inst = "10001100110001000000000000000000"
    emit(inst,pc,"lw $4, 0($6)")
    pc += 4

    # 00000000000000000000000000100000
    inst = "10001100110001010000000000000100"
    emit(inst,pc,"lw $5, 4($6)")
    pc += 4

    # 00000000000000000000000000100100
    inst = "00000000101001000001100000011010"
    emit(inst,pc,"slt $3, $5, $4")
    pc += 4

    # 00000000000000000000000000101000
    inst = "00010000011000000000000000000011"
    emit(inst,pc,"beq $3, $0, exit2")
    pc += 4

    # 00000000000000000000000000101100
    inst = "00001100000000000000000000010001"
    emit(inst,pc,"jal swap")
    pc += 4

    # 00000000000000000000000000110000
    inst = "00100000010000101111111111111111"
    emit(inst,pc,"addi $2, $2, -1")
    pc += 4

    # 00000000000000000000000000110100
    inst = "00001000000000000000000000000011"
    emit(inst,pc,"j for2tst")
    pc += 4

    # 00000000000000000000000000111000
    inst = "00100000001000010000000000000001"
    emit(inst,pc,"exit2: addi $1, $1, 1")
    pc += 4

    # 00000000000000000000000000111100
    inst = "00001000000000000000000000000000"
    emit(inst,pc,"j for1tst")
    pc += 4

    # 00000000000000000000000001000000
    inst = "11111111111111111111111111111111"
    emit(inst,pc,"exit1: FIM DA EXECUCAO")
    pc += 4

    # 00000000000000000000000001000100
    inst = "10101100110001000000000000000100"
    emit(inst,pc,"sw $4, 4($6)")
    pc += 4

    # 00000000000000000000000001001000
    inst = "10101100110001010000000000000000"
    emit(inst,pc,"sw $5, 0($6)")
    pc += 4

    # 00000000000000000000000001001100
    inst = "00000000111000000000000000001000"
    emit(inst,pc,"jr $7")
    pc += 4

    pc = 0x80

    for i in range(int(sys.argv[1])):
        dado = random.randint(-2**16,2**16-1)
        emit(stringBin(dado,32),pc,"DADO: "+str(dado))
        pc += 4

    pass

def stringBin(nm, ln):
    ret = ""
    if nm < 0:
        nm = 2**ln + nm
    for i in range(ln):
        ret = str(nm % 2) + ret
        nm = nm // 2
    return ret

def emit(inst,pc,obs):
    print(stringBin(pc,32)+"|"+inst+"|"+obs+"|"+hexS(inst))

def hexS(inst):
    lt = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'A', 'B', 'C', 'D', 'E', 'F']
    ret = ''
    while inst != '':
        part = inst[0:4]
        inst = inst[4:]
        num = 0
        if part[0] == '1':
            num += 8
        if part[1] == '1':
            num += 4
        if part[2] == '1':
            num += 2
        if part[3] == '1':
            num += 1
        ret += lt[num]
    return ret

main()
